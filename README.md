# Bug-Records
记录一下遇见过的问题bug

### 1.
问题：玩家进行装备重铸的时候， 出现报错，无法进行战力刷新。玩家在下线之后，服务端实体释放之后，玩家再重新登录，无法登录，登录报错。

定位：逻辑是战力刷新函数中，遍历各个装备位置上的属性id， 通过属性id查找配置中的属性字段配置。报错是在遍历属性配置的时候报错了。所以定位到问题是配置找不到记录的属性id。

bug排查：1。检查配置，配置正常没有遗漏id。2.检查开发版本的代码和分支代码，代码一致。3.业务逻辑代码检查，发现在进行装备重铸的时候，该位置没有数据会进行初始化设置默认数据，然后在接下来的业务逻辑中，有一些拦截判断会执行return（判断到读取不到配置或者消耗不足时），当触发了拦截，该位置的属性id会默认为0（没有执行成功随机属性id，故id依旧为默认数据0）. 属性配置中没有属性id为0的配置，所以当进行战力刷新时，读取不到配置就报错了。

解决方式：优化业务逻辑代码（初始没有数据并且没有成功执行重铸的数据，不记录数据， 应当使用临时数据处理业务逻辑）以及战力刷新函数添加配置为空的判断。

### 2.
问题：更新代码之后，登录游戏某个旧功能出现报错,之前没有出现该问题

原因：分析排查该旧功能代码，逻辑没有问题，依据报错堆栈，发现是EnterGame的时候执行到角色升级代码，当角色升级时触发了升级事件。其他模块没有执行玩EnterGame的初始化数据操作，该旧功能也是没有执行到初始化数据旧触发了事件，这个时候取不到数据就报错了。

解决方式：排查EnterGame中的模块，通知相关功能的人员调整代码，不要在没有完全初始化的时候就执行一些业务逻辑代码。

### 3.
问题：角色进入游戏触发了某个系统解锁，发生报错

原因：写新功能时，复制了该系统的代码，使用了该系统的字段，当新功能插入数据时将该系统的字段数据覆盖了

解决方式：复制代码需要了解清楚该模块的相关流程以及关联性，不能简单粗暴的复制代码，需要细心检查



### 4.
问题：非游戏业务。自己练习代码时，启动服务连接skynet mysql，发现报了：Plugin 'mysql_native_password' is not loaded
原因：mysql_native_password 插件(模式)在新版本中被弃用了，新模式为 caching_sha2_password，需要启用一下旧模式。
解决方式：
打开配置vi /etc/my.cnf  
在[mysqld]添加
mysql_native_password=ON
重启 MySQL 服务：systemctl restart mysqld
在mysql中执行：
ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '数据库密码';
FLUSH PRIVILEGES;
